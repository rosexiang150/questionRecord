##### day1 接口测试

##### 接口

接口:数据交互的入口和出口,是一套规范,一套标准.

分类:

硬件:USB接口  电源接口  网线接口

软件:前后端共同遵守的一套数据交互的规范

不使用接口的缺点:

1,研发标准不统一,团队磨合难度高  2,增加了研发周期   3,可扩展性差(需要频繁沟通)

使用接口的好处:

1,统一了设计标准  2,前后端开发相对独立  3,扩展性灵活   4,前后端都可以使用自己熟悉的技术

高效,灵活:前端和后端不用频繁沟通,看相关文档就行

##### 接口测试

接口测试主要测后端,看后端编写的程序是否符合接口规范.

接口测试的实现流程(模拟用户向服务器发送数据,然后查看响应):

要素1:定位服务器资源,通过URL实现

要素2:模拟用户提交数据

要素3:查看响应的结果是否符合预期

接口测试的分类:

1,web接口测试(BS架构):

a,服务器接口测试:测试本公司实现的接口

b,第三方接口测试:测试别的公司实现的接口

2,模块接口测试(CS架构)



##### 接口的环境搭建:

1. 安装python环境  推荐python3.5以上版本

2. 安装依赖模块：pip install -r requirements.txt -i https://pypi.douban.com/simple (在E:\TestVideo\第五阶段  接口测试+shell\接口测试day01\接口项目源码 打开cmd, 复制粘贴到dos命令行,)在dos命令行输入(第5条)     

3. (如果须使用mysql，那么需要将studentManagementSystem/studentManagementSystem/settings.py的第78行的配置更改一下，注释掉sqllite3，解注释mysql的配置

4. 执行studentManagementSystem.sql文件，生成数据库)

5. 启动命令：python run_server.py

6. 默认端口是8000，地址本机ip

   ​

   ##### SQLiteStudio安装

   E:\TestVideo\【赠】软件测试相搭配的所有工具安装包\接口相关软件\SQLiteStudio\SQLiteStudio.exe

   安装成功后的图标是个银白色圆筒,然后可以把数据如db.sqlite3拖到SQLiteStudio左边部分,  在tables中,选择classes--Generate....-----select---在右部分就打开了-----点击运行

   ##### 接口测试用的插件

   火狐浏览器------RESTClient      我安装的时候对火狐浏览器要求是48版本,35版本安装不上啊

   谷歌浏览器------POSTman

   谷歌浏览器安装包位置:E:\TestVideo\【赠】软件测试相搭配的所有工具安装包\接口相关软件\谷歌

   java实现的测试工具------Jmeter(重点)

   ​

   ##### 接口测试风格:RESTful

   RESTful风格:开发测试时,大家习惯遵守的一些默任的规范. 

   RESTful风格中规范了URL的实现方式,提交数据的实现方式,响应数据的实现方式.........

   RESTful风格是为了程序的易读性和易维护性

   RESTful用法:

   ​

   ​

   响应状态:客户端请求服务器后,服务器响应给客户端的状态码

   RESTful请求方式:1,GET(获取资源) 状态码:200         2,POST(新增资源)状态码:200/201     3,PUT(更新资源)状态码:200/201     4,DELETE(删除资源)状态码:204

   ​

##### json

json是一种数据载体

互联网的本质是数据传输,数据传输需要数据载体.比如页面信息是存储在html这种数据载体中的.xml也是数据载体.

标签标记语言,有效数据占有率低

json优化数据传输:效率高,所以部分场景下使用json替换html和xml

json语法缺点是描述性不及标签语言

如果传递的是少量数据,可能使用json

json语法格式:

json对象  {'键1':'值1','键2':'值2','键n':'值n'}

json数组    [值1,值2,值n]

格式复合   对象里有数组 ,如 {'name':'lucy','age':'8','hobby':['run','jump','swim']

​		数组里有对象   [{'name':'lucy'},{'name':'nancy'},{'name':'kelly'},]

##### 接口测试的增删改查

列表集合查询方法:

参数规则 $字段名_list, 使用英文逗号分隔多个值  如http://127.0.0.1:8000/api/departments/?$dep_id_list=T01,T02,T03

单个查询:http://127.0.0.1:8000/api/departments/T02/

模糊查询:默任不开启默任查询,blur=1将开启模糊查询,如http://127.0.0.1:8000/api/departments/?blur=1&dep_name=C  查询学院名称包含C

接口测试的增删改查没看



##### day2 jmeter

jmeter是apache公司使用java开发的一款测试工具

特点:高效,功能强大,模拟一些高并发或多次循环等特殊测试场景.





jmeter的作用及优缺点:

作用:1,接口测试   2,性能测试(测内在,程序的算法,看响应时间)    3,压力测试(测外在,外在的负载量

4,web自动化测试   5,数据库测试  6,java程序测试

缺点:1,不支持IP欺骗    2,不支持前端测试

##### 搭建jmeter环境

安装包路径-----> E:\TestVideo\【赠】软件测试相搭配的所有工具安装包\接口相关软件

1,下载jmeter,解压缩

2,java环境的安装

java环境的安装:

 双击 jdk-8u144-windows-x64.exe, 点击安装,安装路径需要修改,因为默任的c盘路径有空格,在   e盘创建一个空的文件夹JRE,剩下的操作就是点击下一步

安装到这一步,jmeter就可以用了

检测是否安装成功,在解压了的apache-jmeter-3.1中---->bin文件夹下----->双击ApacheJMeter.jar--->出现测试计划,工作台界面即成功启动jmeter.

3,了解jmeter的目录结构

 bin目录存储了jmeter的可执行程序,比如启动程序

 lib目录存储了jmeter整合的功能,比如.jar文件的小程序

4,启动jmeter

5,编写一个jmeter版本的测试案例

##### 在学生管理系统案例中,先在项目源码文件目录下打开cmd,输入python run_server.py 即启动数据

a,在测试计划名称下写个名称-----ctrl+s保存到目标文件夹下.

b,右击 左侧的测试计划-----添加------Threads-----选择线程组----在右侧的线程组可起名,比如线程组1,则左边的测试计划下有个分支叫线程组1.

右击左侧的线程组1-----添加-----Sample----HTTP请求

在第一个跟目录测试计划右击-----添加-----监听器------查看结果树,在查看结果树页面右侧,选择你需要的数据类型,text,json,html等格式(取样器结果的左边修改).

##### 测试计划右击-----......----HTTP信息头管理器 :  名称: Content-Type    值 application/json;charset=utf-8

##### jmeter组件:线程组

进程:一个正在执行的程序就对应一个进程

线程:进程中的执行线索(一个进程有多个执行线索)

线程组:按照线程性质对线程进行分组

并发执行:多个线程同时执行  特点:执行结束的顺序和线程的启动顺序不一定一致

顺序执行:按照线程的启动顺序挨个执行

进程,线程,线程组三者之间的关系:进程可以有多个线程组,一个线程组可以有多个线程

测试计划----------进程

线程组-------------线程组

线程组属性的线程数-----线程

默任情况下,线程组中的线程是并发执行的, 每一个线程都要执行组内的http请求.

但可以设置线程组的执行顺序:勾选测试计划的第一个复选框,即独立运行每个线程组.

##### 线程组高级应用

线程组属性:属性1  线程数-----模拟用户数              属性2  Ramp-Up Period 时间值----在指定时间内启动所有线程   属性3  循环数------单个用户访问的次数

socket端口号  高并发或循环访问的时候,服务器由于自身原因,有可能出现一定的错误率,比如1万个访问出现100个错误异常,

调度器 :

 1)循环次数设置为  永远   

2)设置启动延迟 m 和持续时间 n 意思是在m秒后访问服务器,并且持续n秒

3)设置启动时间x  和结束时间y   意思是在x时开始访问,在y时结束

注意:2和3不能同时使用,因为冲突

##### 参数化

参数化是动态获取并设置数据

使用参数化的原因:比如执行批量操作,批量插入或批量删除,之前的数据是手写的,每执行完都需要修改一次,效率低. 参数化就是可以程序代替人工获取并设置数据,比较安全,高效.

##### 参数化实现组件之一: CSV Data Set Config

 CSV:逗号分隔值文件格式

做接口测试时,开启软件有:

1),打开jmeter软件,进行主要的操作.  

2),在存储数据的文件夹路径输入cmd回车,输入启动数据的命令python run_server.py  出现8000端口号即成功.

3),打开SQLite,把存储数据的文件包放进去,这里面有原本的数据,还有jmeter操作后,查看数据的变化

CSV Data Set Config操作步骤:

因为数据的分类很多,比如学生表,班级表,学院表,一个表又有增删等操作,所以操作时,线程组中的线程http请求,要更改方法及路径(默任的设值单独用线程组HTTP请求默任值)

1)在和线程组的同一个文件夹新建一个文件夹,用于存放文本.txt,文本的内容是批量操作的数据,数据格式为每行写一条记录,用英文逗号分隔,本行的最后一个字段无逗号

2)jmeter中,线程组中添加CSV Data Set Config, filename: 数据文本的路径及名字  file encoding:utf-8  也检查一个文本的编码是否为utf-8  variable names对应每一行的字段(这样1和2就连接起来)

3)jmeter中,在线程组添加HTTP请求,在Body Data设置格式,要讲CSV解析的数据设置进去,json格式的请求报文,语法为${2中的variable names}(这样3和2就连接起来)

##### jmeter组件之set up,tear down

测试计划----添加---set up 此线程组为最先执行的线程组,多用于加载程序主体执行所需的资源

tear down 最后执行的线程组,多为程序正式关闭之前,可以将数据保存进内存.

------

##### day3   jmeter组件

jmeter参数化组件:

CSV Data Set Config-----CSV数据设置组件(上述学过)

用户参数

用户定义的变量

函数

##### 用户参数

使用用户参数方法向学生管理系统的学院表里,批量插入数据 

实现思想和CSV类似,都是将数据设置进第三方,然后循环读取数据,区别是CSV是将数据设置在外部的文本文档,用户参数是将数据设置在jmeter内置组件---用户参数

此法比CSV简单

步骤:

1)搭框架:测试计划,http信息头管理器,http请求默任值,查看结果数,用户参数,线程组(多少个用户就设置多少个线程数)

2)在用户参数(测试计划--添加--前置处理器---用户参数),存储要插入的数据,第一列名称字段设置对应文本内容

3)在线程组http请求的报文中,设置json格式,语法为${变量名}

##### 用户变量

用户变量用于解决系统内有多个线程时,资源路径不同,每次编写路径时效率低,所以把公共的路径(全局的变量)存储在用户变量中

测试计划----添加---配置元件------用户定义的变量

在用户定义的变量中,添加  名称为简写的路径        值为公共的路径

在线程组的线程http请求中,路径为${名称}+独有的路径

##### 函数

需求是循环10次,查询学院信息.因为在查看结果树中,每次的请求信息都是一样,所以需要添加标号以示区分.

函数时程序中最基本的封装单元,封装了一些常用功能,比如计数器

工具栏倒数第二个为函数助手

步骤:

1)jmeter的工具栏倒数第二个为函数助手,点击----在弹出的对话框中选择一个你需要的函数

2)选择要使用的函数,给函数传参后,点击生成, 则生成调用格式,然后把这个复制一下

3)在jmeter中,粘贴在需要调用函数的位置

##### 参数化的四种方式比较

1,CSV和用户参数使用思想一致,流程上后者简单.但实际应用CSV较多,因为数据量巨大时,CSV方便.数据量少时,用户参数方便.

2,用户定义的变量一般用来存储全局变量,比如共享的路径,但是使用场景较少.

3,函数实现更为灵活,并且内置了很多实现

4,最常用的为CSV和函数

##### jmeter组件之   直连数据库

直连数据库是让jmeter直接和数据交互

之前是通过接口操作数据库,可能出现的问题:比如查询可能有漏查误查的情况,解决方案是人工比对,效率低,有安全隐患.  解决方案是:让程序代替人工

直连数据库用法:

1) jmeter没有直连数据库的功能,需要整合第三方数据库:在测试计划的Add directory or jar to classpath---浏览---找到sqlite-jdbc-3.21.0.jar

jmeter就连接到数据库了

不同的数据库对应不同的jar包,如mysql,oracle等有各自的jar包

2) 配置数据库的一些连接信息

测试计划--添加---配置元件----JDBC Connection Configuration,  

 variable name:  mySQLite Config(起的名字见名知意)

##### database url:         jdbc:sqlite:数据库的路径(路径需要加单斜杠\\)  

如jdbc:sqlite:E:\\\TestVideo\\\第五阶段  接口测试+shell\\\接口测试day01\\\接口项目源码\\\studentManagementSystem\\\db.sqlite3

##### jdbc driver class:org.sqlite.JDBC

3)   创建取样器(JDBC Request)

在线程组中-----添加-----sampler-----jdbc request   此表中,variable name: 和2中的variable name填写的内容一致.

query type:  select statement为查询语句的类型   update statement 为增加,删除,修改语句的 类型

query面板中,填写sql语句

4)对JDBC查询的结果取出,并且传递给另一个取样器

需求: 查询学院表中的学院名,然后在百度中搜索第8个学院名

1)jdbc request 中设置variable name:mySQLiteConfig,设置query type, 及query, 在下面的variable names设置要操作的变量名,如dep_name.   jdbc request操作数据库时,会将查询的结果赋值给变量dep_name

2)由于结果可能有多个,取第n个结果,则为dep_name_n 此方法对数据量少实用,数据多用下面的方法

2-2)在学院表下方新建debug sampler ,查看响应的数据. 即可查看dep_name_n (线程组---添加-----sampler-----debug sampler)

3)其他取样器,如线程http请求,使用数据调用格式为 $              ${变量名_n},   如 ${dep_name_8}

##### jmeter组件之 关联

关联是一个请求的结果是另一个请求提交的数据,两者不再是独立存在的.

目的是为了实现多样的业务逻辑(可能由多个请求组合而成)

用法: 

实现方案1:JDBC中将结果赋值给变量,再在另一个请求调用变量

实现方案2:Xpath提取器

如果从标签语言提取数据,最好使用xpath提取器

实现方案3:正则表达式提取器

如果想要的数据是文本格式,正则表达式提取器更方便

案例:访问百度官网,在html中提取title数据,然后在谷歌官网上搜这个title数据

##### 环境变量

环境变量:系统设置之一,通过设置path,可以让程序在dos命令行直接启动

path 用法:如果想让一个程序在dos命令行直接启动,需要将该程序的目录配置进path

path和我们的关系:要配置JDK的环境变量

比如想在dos命令行直接打开.txt文件,操作如下:

1),计算机(最左下方)-------设置(齿轮图标)-------系统------在搜索框输入 查看高级系统设置-----高级-----环境变量--------系统变量------Path---

2),桌面上需要被启动的程序右击---属性-----复制 起始位置

3),在第1步的path-------编辑-------弹出的页面在空白行  粘贴(第2步复制的路径)

##### JDK配置path环境变量

要求是在任意目录下可执行javacpl程序

1),找到javacpl程序所在的文件路径:  E:\testProgram\JDK

2)环境变量--------系统变量----新建---在弹出的对话框,变量名: JAVA_HOME  值: E:\testProgram\JDK   (bin目录的父级) 点击确定

3)系统变量---path-----编辑-----空白行%JAVA_HOME%\bin  (bin目录,即javacpl的父目录)----确定

------

##### day4

##### jmeter组件之断言

断言:程序代替人工,判断响应结果是否符合预期

分类:断言响应的状态码  断言响应的内容  断言响应的内容的字节数   断言响应的时间

添加方法: 线程----添加------断言

##### jmeter组件之  集合点



使用集合点原因:模拟高并发实现,测试服务器性能

用法:

场景:模拟N个用户在同一时刻查询学院信息的操作 

1),搭建框架,线程组通过线程数来模拟多个用户

2),添加集合点组件: http请求右击-----添加-----定时器----synchronizing timer(同步定时器)  设置一组用户数及超时时间  其中超时时间如果设为0,为无限等待, 无限等待时,如果线程数小于集合点的一组线程数,则会挂起.建议: 线程数=一组用户数, 或者线程数是一组用户数的整数倍.

3),运行 查看结果

测试计划右击---添加----监听器----聚合报告

##### jmeter组件之  函数

函数时程序中的封装单元,封装了一些功能实现.

函数的用法流程:

1),打开jmeter内置的函数功能模块

2),选择要调用的函数,传参数,点击生成调用格式,并复制

3),哪里需要粘哪里

函数分类:

1),数字类

__counter():  计数器

__random():   随机数函数

__time():  获取时间的函数    时间格式为 yyyy/MM/dd HH:mm:ss



2),读取CSV文件类

__CSVRead():  读取CSV文件数据

需求:使用CSVRead函数实现学院信息的批量插入

思想:

a,搭建框架

b,将数据存储在外部的文本文档(CSV格式)  

 c,使用CSVRead函数逐行获取并解析CSV格式的文件,插入到提交的json数据中.

其中CSVRead函数第一个参数是文本路径,写到.txt 必须使用绝对路径.   第二个参数是列表号,列表是有索引的,从0开始.然后点击生成.复制,在json数据中依次粘贴并修改索引.

3),属性

__setProperty()  属性设置

__property()   属性获取

应用场景不多

##### jmeter之分布式

分布式是多态测试机协作(集群方式)完成测试任务

用法:

控制机:  任务分发+结果汇总

执行机:  接任务+做任务

环境搭建

模拟伪分布环境,一台设备模拟3台

1),复制3份apache-jmeter-3.1目录,一个是控制机,一个是执行机A,一个是执行机B,因为要同时启动,然后网络间进行数据交互,需要修改端口号.

修改执行机的端口号,方法:执行机A的jmeter文件夹----bin----jmeter.properties---打开后,ctrl+f搜port 比如#server_port=1099改为server_port=3333(数值大于1024),执行机B的方法一样,比如server_port=4444

控制机要寻址执行机,在控制机的jmeter文件夹----bin----jmeter.properties---#remote_host,操作是去掉注释#,并把ip后面的端口号改为3333,4444

注意:配置文件一旦发生修改,需要关闭重启后才生效

3)分布式测试:

需求:分配300个用户给执行机A和B

a,在控制机jmeter上编写相关脚本

b,分配给执行机

执行机:打开jmeter文件夹---bin---jmeter-server.bat双击------即启动执行机端口.  只有执行机都启动,控制机才发任务

控制机: jmeter的线程组---线程数150,添加http请求,聚合报告,脚本写好了.菜单栏运行-----远程全部启动

##### day5

##### jmeter组件之逻辑控制器

逻辑控制器可以控制取样器的实现顺序(分支+循环)的 一种组件

应用:实现多样的业务逻辑

分类:a,分支控制器----If控制器:符合条件就执行

​	b,往复控制器----forEach控制器+循环控制器: 循环执行

需求1:测试计划中3个http请求,分别访问百度,淘宝,京东,不是无差异的都执行,而是有选择性的执行,定义一个用户定义的变量,如果值是百度,就访问百度,是淘宝就访问淘宝.....

If控制器:

搭框架(测试计划,结果树,用户定义的变量,线程组,http请求)

a,测试计划右击----添加----配置元件----用户定义的变量, 用户定义的变量存储变量名和指定的变量值

b,线程组---if控制器----调用a的变量名,及自身的变量值, 格式 "${变量名}" == "变量值"

c,线程组---添加---逻辑控制器---if控制器.  在if控制器添加http请求 如果b的变量值和a的变量值相等,则相应http请求.如果不等,则不响应.

需求3:循环查询所有学院信息10次

循环控制器:

线程组设置的循环次数控制组内所有请求的循环次数.而循环控制器控制某些请求的循环次数.

forEach控制器:

需求2:有一组关键字[hello,python,测试]要依次取出,并在百度搜索.

##### jmeter组件之QPS

QPS:query per second

20QPS == 每秒访问20次

案例:1个用户以20QPS的频率访问服务器,持续10秒,查看服务器的平均响应时间

实现流程:

1),搭框架(线程组,http请求,聚合报告...) 其中线程组的循环次数设置:频率*持续时间

2),添加常量吞吐定时器,http请求 ----添加---定时器---ConstantThroughOutTimer,将QPS每秒查询数*60,换算成每分钟的

3),查看聚合报告,其中throughput显示的是每秒查询数,实际执行一般围绕QPS的值上下波动.

##### jmeter组件综合

1,组件的作用域

作用域是组件的作用范围

作用域的分类:

第一类,以聚合报告为例,只对树形结构上,自己的直接父级以及兄弟以及子级...有效,基本所有组件都属于这类

第二类,逻辑控制器,只对子级有效

第三类,取样器,可以不依赖任何组件存在,可以不对其他组件产生任何影响.取样器无作用域概念.

2,组件的执行顺序

组件:jmeter的内置功能,每一个组件是一个功能

元件:一个元件中存储的是性质相似的组件,元件是对组件的分类管理

7大元件之间的执行先后顺序:

1),配置元件(config dlement): 存储了一些程序的全局性数据.  比如http信息头管理器

2),前置处理程序(per-processors): 取样器执行之前的组件,可以存储批量执行的数据. 比如用户参数

3),定时器(timer) :在请求执行集合用户

4),取样器(sampler):访问服务器

5),后置处理程序(post-processors):处理响应的结果

6)断言(assertions)

7),监听器(listeners):最后执行

##### jmeter组件之FTP

FTP是文件上传和下载

上传:将文件从本地上传到服务器

下载:将服务器资源下载到本地

是程序中常见的操作

用法:

1),保证服务器程序具备文件上传和下载的功能,安装一个FTP服务器

2),jmeter内置了FTP请求,可以通过此请求实现文件传输测试

没有安装包资料

##### 接口清单整理

接口清单组成:功能模块,每个功能模块有3个要素:url+提交的数据+响应的数据

API文档:此文档中声明了程序的功能,以及该功能描述及访问的资源路径和提交的响应数据.....是开发和测试共同遵守的文档说明.

接口清单是从API文档提取整理的.

API文档的写法:

1),描述性文本尽量占到50%及以上

2),格式清晰,规范,风格统一

3),业务逻辑设计时,全面,合理

------

##### 自动化测试

自动化测试原则:

1),测试程序的主要功能以及一些经常被复用的功能

2),自动化测试数据一般只考虑正向数据

3),自动化测试完毕,数据库数据必须恢复成测试之前的状态,优点:可以重复使用,功能测试不可以

4),线程组之间不要有关联,不要有业务逻辑,优点:可以单独测试某一个功能



















